# タスクを依頼されたときに厳守するルール
## 共通ルール
- あなたは有能なアシスタントです。Reasoningでは英語で考えて、ユーザーに回答するときは日本語で答えてください。
- 作業途中で疑問点が生じたら、必ず作業を停止しすぐにユーザーに確認してください。y/nでユーザー確認を取り、yが返るまで一切の実行を停止する。
- あなたは迂回や別アプローチを勝手に行わず、最初の計画が失敗したら次の計画の確認を取る
- 一時的なファイルの保存が必要であれば、 `z/` に自由に保存して良いです
- ツールの結果を受け取った後、その品質を慎重に検討し、次に進む前に最適な次のステップを決定してください。この新しい情報に基づいて計画し、反復するために思考を使用し、最善の次のアクションを取ってください。
- 最大の効率を得るために、複数の独立した操作を実行する必要がある場合は、順次ではなく、関連するすべてのツールを同時に呼び出してください。
- リファクタリングは、`Kent BeckのTidyings`に従ってください

## Kent BeckのTidyings
### 基本方針
- コードを綺麗にする: 振る舞いを変更せず、コードの構造を改善
- 小さな変更を積み重ねる: 一度に一つの整理
- 常にCIをグリーンに保つ: 各整理の後に必ずテストを実行し、パスすることを確認
- 自信を持って進める: 常に安全な状態を保ち、いつでも元に戻せるように
- 本質的な変更と分離する: 機能追加やバグ修正といった「振る舞いの変更」と、「構造の改善」を明確に区別する。

### Tidyings実践のコツ
1. 構造的変更の特定: まず、コードの可読性や保守性を下げる「悪い構造」を見つけ出す
2. 単一の整理を実行: 一度に一つの整理（例：変数のリネーム、関数の抽出）のみを行う
3. テストの実行: 整理が終わるたびに、すぐにテストスイート全体を実行して、何も壊していないことを確認する
4. コミット: テストが通ったら、その整理内容だけでコミットする。コミットメッセージは「Tidying: [行った整理の内容]」のように明確にする
5. 繰り返し: 次の整理箇所を見つけて、このサイクル（整理→テスト→コミット）を繰り返す
6. 振る舞いの変更は別で行う: 全ての整理が終わった後、あるいは整理の合間に、機能追加やバグ修正といった本質的な変更を別のコミットとして行う

## git関連のルール
- mainブランチでは作業せず、別のブランチで作業しなさい
- 必ず細かい単位で `git commit` しながらタスクを進めなさい
  - 特に、機能追加(feature)とリファクタリング(refactor)など、異なる方向の作業を1つのcommitで行ってはいけない
  - 形式: `prefix: 日本語で説明`

# プロジェクト概要
複数のブラウザゲームをまとめたコレクションプロジェクト。各ゲームは独立したサブディレクトリに配置され、GitHub Pages上で公開されます。

## 公開設定
- **プラットフォーム**: GitHub Pages
- **アクセス方法**: `https://[username].github.io/browser-games/[ゲーム名]/`
- **運用方針**: 静的ファイルのみ（ビルド工程なし）

## 開発ルール
1. **エントリーポイント**: 各ゲームは `index.html` から開始
2. **独立性**: ゲーム間で名前衝突を防ぐ
3. **CDN利用**: 外部ライブラリはCDN参照を推奨

## 開発用コマンド
npm run lint              # ESLintでコードチェック
npm run lint:fix           # ESLint自動修正
npm run format             # Prettierでフォーマット
npm run check-format       # フォーマットチェック

## タスク実行の4段階フロー

### 1. 要件定義
- `.claude_workflow/complete.md`が存在すれば参照
- 目的の明確化、現状把握、成功基準の設定
- `.claude_workflow/requirements.md`に文書化
- **必須確認**: 「要件定義フェーズが完了しました。設計フェーズに進んでよろしいですか？」

### 2. 設計
- **必ず`.claude_workflow/requirements.md`を読み込んでから開始**
- アプローチ検討、実施手順決定、問題点の特定
- `.claude_workflow/design.md`に文書化
- **必須確認**: 「設計フェーズが完了しました。タスク化フェーズに進んでよろしいですか？」

### 3. タスク化
- **必ず`.claude_workflow/design.md`を読み込んでから開始**
- タスクを実行可能な単位に分解、優先順位設定
- `.claude_workflow/tasks.md`に文書化
- **必須確認**: 「タスク化フェーズが完了しました。実行フェーズに進んでよろしいですか？」

### 4. 実行
- **必ず`.claude_workflow/tasks.md`を読み込んでから開始**
- タスクを順次実行、進捗を`.claude_workflow/tasks.md`に更新
- 各タスク完了時に報告

## 実行ルール
### ファイル操作
- 新規タスク開始時: 既存ファイルの**内容を全て削除して白紙から書き直す**
- ファイル編集前に必ず現在の内容を確認

### フェーズ管理
- 各段階開始時: 「前段階のmdファイルを読み込みました」と報告
- 各段階の最後に、期待通りの結果になっているか確認
- 要件定義なしにいきなり実装を始めない

### 実行方針
- 段階的に進める: 一度に全てを変更せず、小さな変更を積み重ねる
- 複数のタスクを同時並行で進めない
- エラーは解決してから次へ進む
- エラーを無視して次のステップに進まない
- 指示にない機能を勝手に追加しない
